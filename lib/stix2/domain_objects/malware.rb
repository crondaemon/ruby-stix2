module Stix2
  module DomainObject
    class Malware < Base
      property :name, coerce: String
      property :description, coerce: String
      property :malware_types, coerce: [String]
      property :is_family, coerce: Stix2.bool
      property :aliases, coerce: [String]
      property :kill_chain_phases, coerce: [KillChainPhase]
      property :first_seen, coerce: Time
      property :last_seen, coerce: Time
      property :operating_system_refs, coerce: [Identifier]
      property :architecture_execution_envs, coerce: [String]
      property :implementation_languages, coerce: [String]
      property :capabilities, coerce: [String]
      property :sample_refs, coerce: [Identifier]

      def initialize(args = {})
        super
        validate_malware_types! if @strict
        validate_architecture_execution_envs! if @strict
        validate_implementation_languages! if @strict
        validate_capabilities! if @strict
      end

      private

      def validate_malware_types!
        Stix2::Validators::Array.new(malware_types, Stix2::MALWARE_TYPE_OV)
      end

      def validate_architecture_execution_envs!
        Stix2::Validators::Array.new(architecture_execution_envs, Stix2::PROCESSOR_ARCHITECTURE_OV)
      end

      def validate_implementation_languages!
        Stix2::Validators::Array.new(implementation_languages, Stix2::IMPLEMENTATION_LANGUAGE_OV)
      end

      def validate_capabilities!
        Stix2::Validators::Array.new(capabilities, Stix2::IMPLEMENTATION_CAPABILITIES_OV)
      end
    end
  end
end
